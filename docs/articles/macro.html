<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>macro • macro</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="macro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">macro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/macro.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/macro-setup.html">Installation and Setup</a>
    </li>
    <li>
      <a href="../articles/macro-language.html">Macro Language Reference</a>
    </li>
    <li>
      <a href="../articles/macro-symtable.html">Symbol Table Functions</a>
    </li>
    <li>
      <a href="../articles/macro-debug.html">Debugging</a>
    </li>
    <li>
      <a href="../articles/macro-globals.html">Global Options</a>
    </li>
    <li>
      <a href="../articles/macro-example1.html">Example 1: Listing</a>
    </li>
    <li>
      <a href="../articles/macro-example2.html">Example 2: Another Listing</a>
    </li>
    <li>
      <a href="../articles/macro-example3.html">Example 3: Table</a>
    </li>
    <li>
      <a href="../articles/macro-faq.html">Frequently Asked Questions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href=".././articles/macro-faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/dbosak01/macro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>macro</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbosak01/macro/blob/HEAD/vignettes/macro.Rmd" class="external-link"><code>vignettes/macro.Rmd</code></a></small>
      <div class="hidden name"><code>macro.Rmd</code></div>

    </div>

    
    
<p>The <strong>macro</strong> package provides macro commands and a
pre-processor for R programs. The package can be useful in several ways.
Before illustrating the functionality, let’s first discuss the macro
concept at a high level.</p>
<div class="section level2">
<h2 id="macro-concept">Macro Concept<a class="anchor" aria-label="anchor" href="#macro-concept"></a>
</h2>
<p>A macro language is like a meta-language for code. The meta-language
runs first, generates the regular code, and then the regular code is
executed to produce some sort of output. It is, at heart, a text
manipulation system.</p>
<p>The SAS® macro language is commonly used in SAS programs. The R
<strong>macro</strong> package was inspired by SAS. Specifically, the
<strong>macro</strong> package aims to mimic SAS macro with “mprint” and
“mfile” options turned on. These options generate a resolved code
file.</p>
</div>
<div class="section level2">
<h2 id="an-r-macro-language">An R Macro Language<a class="anchor" aria-label="anchor" href="#an-r-macro-language"></a>
</h2>
<p>Clearly, a macro language for R will not be the same as the SAS macro
language. The SAS macro language is built into the SAS execution
environment. The SAS pre-processor is run automatically, and the macro
syntax is understood by the SAS syntax checker.</p>
<p>With R, none of the above applies. R does not have a built-in macro
language, does not have a built-in pre-processor, and the R syntax
checker will not expect any sort of macro language syntax.</p>
<p>Therefore, to build macro-like functionality in R, we must get a
little creative.</p>
</div>
<div class="section level2">
<h2 id="macro-statements">Macro Statements<a class="anchor" aria-label="anchor" href="#macro-statements"></a>
</h2>
<p>The first thing to note is that macro statements in the
<strong>macro</strong> package are written as code comments. The
comments ensure that the R syntax checker will not generate an error
when parsing the macro functions.</p>
<p>In SAS, macro functions are prefixed with a percent sign (%). In R,
macro statements are therefore prefixed with a comment symbol (#) and a
percent sign (%). A simple macro assignment looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#%let x &lt;- 1</span></span></code></pre></div>
<p>A simple macro conditional looks like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#%if (&amp;x == 1)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"x is one!"</span><span class="op">)</span></span>
<span><span class="co">#%else</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"x is something else!"</span><span class="op">)</span></span>
<span><span class="co">#%end</span></span></code></pre></div>
<p>Note that the above R macro syntax is not identical to the SAS
syntax. The syntax devised for the <strong>macro</strong> package is a
blend of SAS and R syntax.</p>
</div>
<div class="section level2">
<h2 id="differences-between-sas-macro-and-r-macro">Differences Between SAS Macro and R Macro<a class="anchor" aria-label="anchor" href="#differences-between-sas-macro-and-r-macro"></a>
</h2>
<p>Here are some of the major difference between the SAS macro language
and the R macro language:</p>
<ul>
<li>R macro statements do not end with a semicolon (“;”). They are
single-line commands, and end with a carriage return.</li>
<li>R macro commands can be used anywhere in the program. They are not
restricted to use inside macro functions.<br>
</li>
<li>Single-quotes will not prevent macro variable resolution. In the R
macro language, single and double quotes operate the same.</li>
<li>All operators in the R macro language use R syntax, including the
comparison operator (“==”).</li>
<li>R macro variables in open code must be surrounded by backticks (“`”)
to avoid syntax errors. Inside comments, strings, and other macro
commands, they do not need backticks.</li>
</ul>
<p>Otherwise, the R macro language is similar to SAS in terms of basic
functionality.</p>
<div class="section level3">
<h3 id="available-functionality">Available Functionality<a class="anchor" aria-label="anchor" href="#available-functionality"></a>
</h3>
<p>The <strong>macro</strong> package supports the most basic
functionality of a macro system. That includes:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Macro Comments</strong>: Like regular R comments, but are
not emitted to the output file.</li>
<li>
<strong>Macro Variables</strong>: Allow you to assign a value to a
macro variable, and use the macro variable as a text replacement
token.</li>
<li>
<strong>Macro Conditionals</strong>: If-Then-Else logic that allows
you to conditionally execute a chunk of code.</li>
<li>
<strong>Macro Include</strong>: Inserts the contents of an external
file into your program.</li>
<li>
<strong>Built-in Macro Functions</strong>: A small number of macro
functions to make the system more practical.</li>
<li>
<strong>Macro Do Loops</strong>: Copies code inside the do block for
each iteration of the loop.</li>
<li>
<strong>User-Defined Macro Functions</strong>: The ability to create
a user-defined text-replacement function, with or without
parameters.</li>
</ol>
<p>The above functionality covers the majority of use cases for a macro
language. Now let’s see how the R macro language is actually
implemented.</p>
<div class="section level4">
<h4 id="sas-to-r-macro-language-map">SAS to R Macro Language Map<a class="anchor" aria-label="anchor" href="#sas-to-r-macro-language-map"></a>
</h4>
<p>The table below maps SAS macro statements to the corresponding
statement in R. This table can help SAS programmers quickly understand
how the <strong>macro</strong> package works.</p>
<style>
.sasstyle {
  color: blue;
  font-family: Courier;
}

.rstyle {
  color: green;
  font-family: Courier;
}
</style>
<table class="table">
<tr>
<td>
 
</td>
<td>
<b>SAS</b>
</td>
<td>
<b>R</b>
</td>
</tr>
<tr>
<td>
<b>Comment:</b>
</td>
<td class="sasstyle">
%* Here is a comment;
</td>
<td class="rstyle">
#% Here is a comment
</td>
</tr>
<tr>
<td>
<b>Assignment:</b>
</td>
<td class="sasstyle">
%let x = 1;
</td>
<td class="rstyle">
#%let x &lt;- 1
</td>
</tr>
<tr>
<td>
<b>Conditional:</b>
</td>
<td class="sasstyle">
%if (&amp;x = 1) %then %do;<br>   %put “First condition”;<br> %end;<br>
%else %if (&amp;x = 2) %then %do;<br>   %put “Second condition”;<br>
%end;<br> %else %do;<br>   %put “Default condition”;<br> %end;<br>
</td>
<td class="rstyle">
#%if (&amp;x == 1)<br>   print(“First condition”)<br> #%elseif (&amp;x
== 2)<br>   print(“Second condition”)<br> #%else<br>   print(“Default
condition”)<br> #%end<br>
</td>
</tr>
<tr>
<td>
<b>Include:</b>
</td>
<td class="sasstyle">
%include “myfile.sas”;
</td>
<td class="rstyle">
#%include “myfile.R”
</td>
</tr>
<tr>
<td>
<b>Built in Functions:</b>
</td>
<td class="sasstyle">
%sysfunc()<br> %symexist()<br> %symput()<br> %nrstr()
</td>
<td class="rstyle">
%sysfunc()<br> %symexist()<br> %symput()<br> %nrstr()
</td>
</tr>
<tr>
<td>
<b>Do Loop:</b>
</td>
<td class="sasstyle">
%do y = 1 %to 3;<br>   %put Y is &amp;y;<br> %end;<br>
</td>
<td class="rstyle">
#%do y = 1 %to 3<br>   print(“Y is &amp;y”)<br> #%end<br>
</td>
</tr>
<tr>
<td>
<b>User-Defined Function:</b>
</td>
<td class="sasstyle">
%macro test();<br>   %put “Hello!”;<br> %mend;<br><br> %test();<br>
</td>
<td class="rstyle">
#%macro test()<br>   print(“Hello!”)<br> #%mend<br><br> #%test()
</td>
</tr>
</table>
<p>The table above contains all of the commands in the R macro language.
For comprehensive documentation, see the <a href="macro-language.html">Macro Languge Reference</a>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-msource-function">The msource() Function<a class="anchor" aria-label="anchor" href="#the-msource-function"></a>
</h2>
<p>In the <strong>macro</strong> package, pre-processing of the macro
code is accomplished by a special function: <code><a href="../reference/msource.html">msource()</a></code>. The
<code><a href="../reference/msource.html">msource()</a></code> function is similar to the <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code>
function in R. The <code><a href="../reference/msource.html">msource()</a></code> function will execute your
code, just like the <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> function. First, however, it
will execute the <strong>macro</strong> pre-processor.</p>
<p>The steps can be summarized as follows:</p>
<p>Step 1: Pre-process the code and resolve all macro language
syntax.<br>
Step 2: Generate a new code file with the resolved code.<br>
Step 3: Execute the resolved code with the <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code>
function.</p>
<p>Notice that the above steps map directly to the way the SAS macro
processor works.</p>
<p>In addition, the R macro language is a text-replacement language,
just like SAS. Macro variables are swapped out with real values as text
replacements. Macro conditions are evaluated, and only the code in the
TRUE macro conditions is executed.</p>
<p>All of the above is handled by the <code><a href="../reference/msource.html">msource()</a></code> function.
<code><a href="../reference/msource.html">msource()</a></code> is the core function in the
<strong>macro</strong> package.</p>
<div class="section level4">
<h4 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h4>
<p>The <code><a href="../reference/msource.html">msource()</a></code> function has several parameters. Here is a
short summary:</p>
<ul>
<li>
<strong>pth</strong>: The path to the macro program.</li>
<li>
<strong>file_out</strong>: An optional path to store the generated
code.</li>
<li>
<strong>envir</strong>: An optional environment to use for program
execution.</li>
<li>
<strong>exec</strong>: A TRUE or FALSE value indicating whether to
execute the generated code.</li>
<li>
<strong>debug</strong>: If TRUE, the function will generate
additional debug information. By default, this information is sent to
the console.</li>
<li>
<strong>debug_out</strong>: An optional file path to send the debug
information.</li>
<li>
<strong>symbolgen</strong>: If TRUE, macro variable values are added
to the debug information.</li>
<li>
<strong>echo</strong>: Echos the generated code to the console. TRUE
by default.</li>
<li>
<strong>clear</strong>: Clears the macro symbol table and macro
function list at the beginning of every call to <code><a href="../reference/msource.html">msource()</a></code>.
TRUE by default.</li>
</ul>
<p>Additional information about the <code><a href="../reference/msource.html">msource()</a></code> parameters is
available in the function reference.</p>
</div>
<div class="section level3">
<h3 id="how-to-use">How to Use<a class="anchor" aria-label="anchor" href="#how-to-use"></a>
</h3>
<p>To use the <strong>macro</strong> package, you will first write your
macro-enabled R code in a regular “.R” code file. You can use RStudio®
or another code editor. The macro statements are written as special
comments, as described above. You can execute a macro-enabled program in
three different ways:</p>
<ul>
<li>From the console</li>
<li>From a script</li>
<li>From a keyboard shortcut</li>
</ul>
<p>The below sections will elaborate on these different approaches.</p>
<div class="section level4">
<h4 id="execute-from-the-console">Execute From the Console<a class="anchor" aria-label="anchor" href="#execute-from-the-console"></a>
</h4>
<p>To execute a macro-enabled program, simply call the
<code><a href="../reference/msource.html">msource()</a></code> function in the console and pass the program
path. If you want to save the generated code, or run in debug mode, pass
the appropriate parameters to <code><a href="../reference/msource.html">msource()</a></code>.</p>
<p>The <code><a href="../reference/msource.html">msource()</a></code> function provides some convenience for
those people working in RStudio. If you are working in RStudio, the
function will use the path of the currently active program by default.
In that case, you don’t even need to pass the program path. Just call
<code><a href="../reference/msource.html">msource()</a></code> in the console with no parameters.</p>
<p>A simple example of executing a macro program from the console is
provided below. For a more extensive example, please see <a href="macro-example1.html">Example 1</a>.</p>
</div>
<div class="section level4">
<h4 id="execute-from-a-script">Execute From a Script<a class="anchor" aria-label="anchor" href="#execute-from-a-script"></a>
</h4>
<p>The <code><a href="../reference/msource.html">msource()</a></code> function can also be sourced from a
regular R program. You can create a driver script to set up some macro
parameters, and then call the <code><a href="../reference/msource.html">msource()</a></code> function from the
driver.</p>
<p>For an example of a driver script, see <a href="macro-example2.html">Example 2</a> or <a href="macro-example3.html">Example 3</a>.</p>
</div>
<div class="section level4">
<h4 id="execute-from-a-keyboard-shortcut">Execute From a Keyboard Shortcut<a class="anchor" aria-label="anchor" href="#execute-from-a-keyboard-shortcut"></a>
</h4>
<p>The core features of the <strong>macro</strong> package are also
available via the RStudio Addin menu and keyboard shortcuts. These
features allow you to use the <strong>macro</strong> package
interactively in RStudio. They make writing and debugging macro-enabled
programs much easier.</p>
<p>See the <a href="macro-setup.html">Installation and Setup</a>
vignette for instructions on how to enable and use the
<strong>macro</strong> keyboard shortcuts.</p>
</div>
</div>
<div class="section level3">
<h3 id="example-macro-program">Example Macro Program<a class="anchor" aria-label="anchor" href="#example-macro-program"></a>
</h3>
<p>Here is what a simple macro-enabled program looks like:</p>
<p><img src="../man/images/sample1.png" alt="Sample Macro Program"></p>
<div class="section level4">
<h4 id="console-output">Console Output<a class="anchor" aria-label="anchor" href="#console-output"></a>
</h4>
<p>If you execute the <code><a href="../reference/msource.html">msource()</a></code> function in the console,
the above program will run and display the following:</p>
<pre><code>&gt; msource()
---------
library(procs)
 library(macro)
 
 # Analysis of 'mpg'
 anl_mpg &lt;- proc_means(mtcars, mpg, class = cyl,
                       output = report)
 
 # Analysis of 'disp'
 anl_disp &lt;- proc_means(mtcars, disp, class = cyl,
                       output = report)
 
 # Analysis of 'drat'
 anl_drat &lt;- proc_means(mtcars, drat, class = cyl,
                       output = report)
 
 # Combine analysis
 final &lt;- list(anl_mpg, anl_disp, anl_drat)
 
 # Print to console
 print(final)
 
 # Print to viewer
 proc_print(final,
            titles = c("Analysis of Selected MTCARS Variables",
                       "by cylinders"))
 
---------
[[1]]
  CLASS VAR  N     MEAN      STD  MIN  MAX
1     4 mpg 11 26.66364 4.509828 21.4 33.9
2     6 mpg  7 19.74286 1.453567 17.8 21.4
3     8 mpg 14 15.10000 2.560048 10.4 19.2

[[2]]
  CLASS  VAR  N     MEAN      STD   MIN   MAX
1     4 disp 11 105.1364 26.87159  71.1 146.7
2     6 disp  7 183.3143 41.56246 145.0 258.0
3     8 disp 14 353.1000 67.77132 275.8 472.0

[[3]]
  CLASS  VAR  N     MEAN       STD  MIN  MAX
1     4 drat 11 4.070909 0.3654711 3.69 4.93
2     6 drat  7 3.585714 0.4760552 2.76 3.92
3     8 drat 14 3.229286 0.3723618 2.76 4.22
</code></pre>
<p>The <code><a href="../reference/msource.html">msource()</a></code> console output contains two sections. The
first section is the generated code. The second section is any printed
output from the generated code. In this way, you can see what code was
actually sourced, and the output of that code.</p>
<p>If you do not wish to see the generated code, set the “echo”
parameter on <code><a href="../reference/msource.html">msource()</a></code> to FALSE.</p>
</div>
<div class="section level4">
<h4 id="viewer-output">Viewer Output<a class="anchor" aria-label="anchor" href="#viewer-output"></a>
</h4>
<p>The above macro program also displayed the analysis in the RStudio
viewer. It looks like this:</p>
<p><img src="../man/images/sample2.png" alt="Sample Macro Program View"></p>
<p>See the <a href="https://procs.r-sassy.org" class="external-link">procs</a> package
documentation for more information about the <code>proc_means()</code>
and <code>proc_print()</code> functions. Both the <strong>macro</strong>
package and the <strong>procs</strong> package are part of the <a href="https://r-sassy.org" class="external-link">sassy</a> system of packages.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="additional-features">Additional Features<a class="anchor" aria-label="anchor" href="#additional-features"></a>
</h2>
<div class="section level3">
<h3 id="symbol-table-functions">Symbol Table Functions<a class="anchor" aria-label="anchor" href="#symbol-table-functions"></a>
</h3>
<p>The functions in the macro package operate via an internal memory
register called the macro symbol table. The symbol table stores the
names and values for any macro variables, and the definition of any
macro functions. The symbol table can be accessed from regular R code
using a special set of functions. The symbol table functions are as
follows:</p>
<ul>
<li>
<strong><code><a href="../reference/symtable.html">symtable()</a></code></strong>: Returns an object
containing the macro symbol table and macro function list. By default,
this object is printed to the console.</li>
<li>
<strong><code><a href="../reference/symclear.html">symclear()</a></code></strong>: Clears the macro symbol
table and deletes any macro function definitions.</li>
<li>
<strong><code><a href="../reference/symget.html">symget()</a></code></strong>: Gets a macro variable value
from the macro symbol table.</li>
<li>
<strong><code><a href="../reference/symput.html">symput()</a></code></strong>: Sets the value of a macro
variable.</li>
</ul>
<p>These functions can be used to observe and manipulate the macro
symbol table from regular R code or from the console.</p>
<div class="section level4">
<h4 id="example-symtable-function">Example Symtable Function<a class="anchor" aria-label="anchor" href="#example-symtable-function"></a>
</h4>
<p>For instance, we can follow up on the <code><a href="../reference/msource.html">msource()</a></code> example
from above by calling the <code><a href="../reference/symtable.html">symtable()</a></code> function in the
console. Like this:</p>
<pre><code>&gt; symtable()
# Macro Symbol Table: 5 macro variables
     Name                       Value
1    &amp;dat                      mtcars
2    &amp;idx                           3
3    &amp;var                        drat
4 &amp;varlst anl_mpg, anl_disp, anl_drat
5   &amp;vars    c("mpg", "disp", "drat")
# Macro Function List: 1 functions
# Function '%get_means': 2 parameters
- dat
- var</code></pre>
<p>The above console output shows the macro symbol table and the macro
function list. This information can be useful for ensuring the program
ran correctly and for debugging.</p>
<p>For a full discussion on the symbol table functions, see the <a href="macro-symtable.html">Symbol Table Functions</a> vignette.</p>
</div>
</div>
<div class="section level3">
<h3 id="debugging">Debugging<a class="anchor" aria-label="anchor" href="#debugging"></a>
</h3>
<p>The <strong>macro</strong> package provides extensive debugging
capabilities. These capabilities can be enabled by activating the
“debug” parameter on the <code><a href="../reference/msource.html">msource()</a></code> function. When
activated, the debug information will be sent to the console.</p>
<p>Let’s illustrate the debug feature by running <code><a href="../reference/msource.html">msource()</a></code>
again for the above sample program, but this time set the “debug”
parameter to TRUE:</p>
<pre><code>&gt; msource(debug = TRUE)
******************************************************************************** 
**  Pre-Processing 
******************************************************************************** 
-    File In: C:/packages/macro/tests/testthat/programs/sample16.R 
-   File Out: C:\Users\dbosa\AppData\Local\Temp\RtmpQhWV50/sample16.R 
******************************************************************************** 
[ In#][Out#]: 
[   1][   1]:  
[   2][   2]: library(procs) 
[   3][   3]: library(macro) 
[   4][   4]:  
[   5][    ]: #% Assign macro variables 
[   6][    ]: #%let dat &lt;- mtcars 
[   7][    ]: #%let vars &lt;- c("mpg", "disp", "drat") 
[   8][    ]:  
[   9][    ]: #% Macro to run proc_means 
[  10][    ]: #%macro get_means(dat, var) 
[  17][    ]:  
[  18][    ]: #% Loop over variables 
[  19][    ]: #%do idx = 1 %to 3 
[  20][    ]: #%let idx &lt;- 1 
[  21][    ]:   #%let var &lt;- mpg 
[  22][    ]:   #%get_means(&amp;dat, &amp;var) 
[  23][    ]: #%let dat &lt;- mtcars 
[  24][    ]: #%let var &lt;- mpg 
[  25][    ]:  
[  26][   5]: # Analysis of 'mpg' 
[  27][   6]: anl_mpg &lt;- proc_means(mtcars, mpg, class = cyl, 
[  28][   7]:                       output = report) 
[  29][   8]:  
[  30][    ]: #%mend get_means 
[  31][    ]: #%let idx &lt;- 2 
[  32][    ]:   #%let var &lt;- disp 
[  33][    ]:   #%get_means(&amp;dat, &amp;var) 
[  34][    ]: #%let dat &lt;- mtcars 
[  35][    ]: #%let var &lt;- disp 
[  36][    ]:  
[  37][   9]: # Analysis of 'disp' 
[  38][  10]: anl_disp &lt;- proc_means(mtcars, disp, class = cyl, 
[  39][  11]:                       output = report) 
[  40][  12]:  
[  41][    ]: #%mend get_means 
[  42][    ]: #%let idx &lt;- 3 
[  43][    ]:   #%let var &lt;- drat 
[  44][    ]:   #%get_means(&amp;dat, &amp;var) 
[  45][    ]: #%let dat &lt;- mtcars 
[  46][    ]: #%let var &lt;- drat 
[  47][    ]:  
[  48][  13]: # Analysis of 'drat' 
[  49][  14]: anl_drat &lt;- proc_means(mtcars, drat, class = cyl, 
[  50][  15]:                       output = report) 
[  51][  16]:  
[  52][    ]: #%mend get_means 
[  53][    ]: #% end do 
[  54][    ]:  
[  55][    ]: #% Create list of analysis datasets 
[  56][    ]: #%let varlst &lt;- anl_mpg, anl_disp, anl_drat 
[  57][    ]:  
[  58][  17]: # Combine analysis 
[  59][  18]: final &lt;- list(anl_mpg, anl_disp, anl_drat) 
[  60][  19]:  
[  61][  20]: # Print to console 
[  62][  21]: print(final) 
[  63][  22]:  
[  64][  23]: # Print to viewer 
[  65][  24]: proc_print(final, 
[  66][  25]:            titles = c("Analysis of Selected MTCARS Variables", 
[  67][  26]:                       "by cylinders")) 
[  68][  27]:  
******************************************************************************** 
**  Execution 
******************************************************************************** 

&gt; library(procs)

&gt; library(macro)

&gt; # Analysis of 'mpg'
&gt; anl_mpg &lt;- proc_means(mtcars, mpg, class = cyl,
+                       output = report)

&gt; # Analysis of 'disp'
&gt; anl_disp &lt;- proc_means(mtcars, disp, class = cyl,
+                       output = report)

&gt; # Analysis of 'drat'
&gt; anl_drat &lt;- proc_means(mtcars, drat, class = cyl,
+                       output = report)

&gt; # Combine analysis
&gt; final &lt;- list(anl_mpg, anl_disp, anl_drat)

&gt; # Print to console
&gt; print(final)
[[1]]
  CLASS VAR  N     MEAN      STD  MIN  MAX
1     4 mpg 11 26.66364 4.509828 21.4 33.9
2     6 mpg  7 19.74286 1.453567 17.8 21.4
3     8 mpg 14 15.10000 2.560048 10.4 19.2

[[2]]
  CLASS  VAR  N     MEAN      STD   MIN   MAX
1     4 disp 11 105.1364 26.87159  71.1 146.7
2     6 disp  7 183.3143 41.56246 145.0 258.0
3     8 disp 14 353.1000 67.77132 275.8 472.0

[[3]]
  CLASS  VAR  N     MEAN       STD  MIN  MAX
1     4 drat 11 4.070909 0.3654711 3.69 4.93
2     6 drat  7 3.585714 0.4760552 2.76 3.92
3     8 drat 14 3.229286 0.3723618 2.76 4.22


&gt; # Print to viewer
&gt; proc_print(final,
+            titles = c("Analysis of Selected MTCARS Variables",
+                       "by cylinders"))
 
******************************************************************************** 
**  End 
******************************************************************************** </code></pre>
<p>The debug information shows how the incoming macro code was
processed. For each incoming line, it shows whether that line was
emitted to the generated code file, and how it was resolved. Any errors
during pre-processing or execution will appear at the point they
occurred. In this way, it is very easy to find which line has the
error.</p>
<p>For a full explanation of the debugging features in the
<strong>macro</strong> package, see the <a href="macro-debug.html">Debugging</a> vignette.</p>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>Here are some more articles for further exploration:</p>
<ul>
<li><a href="macro-setup.html">Installation and Setup</a></li>
<li><a href="macro-language.html">Macro Language Reference</a></li>
<li><a href="macro-symtable.html">Symbol Table Functions</a></li>
<li><a href="macro-debug.html">Debugging</a></li>
<li><a href="macro-globals.html">Global Options</a></li>
<li><a href="macro-example1.html">Example 1: Listing</a></li>
<li><a href="macro-example2.html">Example 2: Another Listing</a></li>
<li><a href="macro-example3.html">Example 3: Table</a></li>
<li><a href="macro-faq.html">Frequently Asked Questions</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>

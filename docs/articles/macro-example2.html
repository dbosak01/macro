<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example 2: Another Listing • macro</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Example 2: Another Listing">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">macro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/macro.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/macro-setup.html">Installation and Setup</a>
    </li>
    <li>
      <a href="../articles/macro-language.html">Macro Language Reference</a>
    </li>
    <li>
      <a href="../articles/macro-symtable.html">Symbol Table Functions</a>
    </li>
    <li>
      <a href="../articles/macro-debug.html">Debugging</a>
    </li>
    <li>
      <a href="../articles/macro-globals.html">Global Options</a>
    </li>
    <li>
      <a href="../articles/macro-example1.html">Example 1: Listing</a>
    </li>
    <li>
      <a href="../articles/macro-example2.html">Example 2: Another Listing</a>
    </li>
    <li>
      <a href="../articles/macro-example3.html">Example 3: Table</a>
    </li>
    <li>
      <a href="../articles/macro-disclaimer.html">Disclaimer</a>
    </li>
    <li>
      <a href="../articles/macro-faq.html">Frequently Asked Questions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href=".././articles/macro-faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/dbosak01/macro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example 2: Another Listing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbosak01/macro/blob/HEAD/vignettes/macro-example2.Rmd" class="external-link"><code>vignettes/macro-example2.Rmd</code></a></small>
      <div class="hidden name"><code>macro-example2.Rmd</code></div>

    </div>

    
    
<p>In this example, we will create the same listing, but in a slightly
different way. This time we’ll add some more complexity.</p>
<div class="section level2">
<h2 id="generate-a-listing">Generate a Listing<a class="anchor" aria-label="anchor" href="#generate-a-listing"></a>
</h2>
<p>To generate the listing, we will still need just two files:</p>
<ul>
<li>A macro driver script</li>
<li>A template listing program</li>
</ul>
<div class="section level3">
<h3 id="macro-driver-script">Macro Driver Script<a class="anchor" aria-label="anchor" href="#macro-driver-script"></a>
</h3>
<p>Here is the macro driver script. What is different is that the macro
driver is written in regular R code. This approach gives you somewhat
more flexibility when populating the macro variable values. The macro
variables are created in the global environment, and then picked up by
<code><a href="../reference/msource.html">msource()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://macro.r-sassy.org">macro</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***********************************#</span></span>
<span><span class="co">#* Define Macro Variables</span></span>
<span><span class="co">#***********************************#</span></span>
<span><span class="va">`&amp;sponsor_name`</span> <span class="op">&lt;-</span> <span class="st">"Acme"</span></span>
<span><span class="va">`&amp;study_name`</span> <span class="op">&lt;-</span> <span class="st">"ABC"</span></span>
<span><span class="va">`&amp;prog_name`</span> <span class="op">&lt;-</span> <span class="st">"l_dm"</span></span>
<span><span class="va">`&amp;base_dir`</span> <span class="op">&lt;-</span> <span class="st">"c:/packages/macro/tests/testthat/examples"</span></span>
<span><span class="va">`&amp;output_dir`</span> <span class="op">&lt;-</span> <span class="st">"&amp;base_dir/output"</span></span>
<span><span class="va">`&amp;data_dir`</span> <span class="op">&lt;-</span> <span class="st">"&amp;base_dir/data"</span></span>
<span><span class="va">`&amp;data_file`</span> <span class="op">&lt;-</span> <span class="st">"dm.rda"</span></span>
<span><span class="va">`&amp;data_name`</span> <span class="op">&lt;-</span> <span class="st">"dm"</span></span>
<span><span class="va">`&amp;titles`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Listing 1.0"</span>, <span class="st">"SDTM Demographics"</span><span class="op">)</span></span>
<span><span class="va">`&amp;footnotes`</span> <span class="op">&lt;-</span> <span class="st">"'Program: &amp;prog_name..R'"</span></span>
<span><span class="va">`&amp;output_type`</span> <span class="op">&lt;-</span> <span class="st">"PDF"</span></span>
<span><span class="va">`&amp;preview`</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="co">#***********************************#</span></span>
<span><span class="co">#* Macro Source Listing Template Code</span></span>
<span><span class="co">#***********************************#</span></span>
<span><span class="fu"><a href="../reference/msource.html">msource</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">`&amp;base_dir`</span>, <span class="st">"templates/lst02.R"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">`&amp;base_dir`</span>, <span class="st">"code/l_dm2.R"</span><span class="op">)</span>,</span>
<span>        debug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Note the following in the above driver:</p>
<ul>
<li>Macro variables can be set in regular R code before
<code><a href="../reference/msource.html">msource()</a></code> is called. The variable names must have a leading
ampersand. These variables will be copied to the macro symbol table when
<code><a href="../reference/msource.html">msource()</a></code> starts.</li>
<li>All text variable values are quoted to conform to standard R
syntax.</li>
<li>The macro variables are still regular R variables, and you can use
them in other functions like <code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste()</a></code> or
<code><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path()</a></code>.</li>
<li>The above approach allows you to execute <code><a href="../reference/msource.html">msource()</a></code>
directly from the driver script. This approach avoids having to run it
on the command line or Addin menu. Instead, you can run it from the
“Source” or “Run” button in your development environment.</li>
<li>The above call to <code><a href="../reference/msource.html">msource()</a></code> includes the
<code>debug = TRUE</code> parameter. This option will generate debug
information in the console. The debug information will be shown
below.</li>
</ul>
<p>Otherwise, the macro driver performs the exact same tasks as the
previous listing example. It sets the macro variable values and executes
the template program.</p>
</div>
<div class="section level3">
<h3 id="template-listing-program">Template Listing Program<a class="anchor" aria-label="anchor" href="#template-listing-program"></a>
</h3>
<p>Here is the template program for the second listing. This template
listing has a few more macro statements than the previous one:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#####################################################################</span></span>
<span><span class="co"># Program Name: &amp;prog_name.</span></span>
<span><span class="co"># Study: &amp;study_name.</span></span>
<span><span class="co">#####################################################################</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://reporter.r-sassy.org" class="external-link">reporter</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output path</span></span>
<span><span class="va">out_pth</span> <span class="op">&lt;-</span> <span class="st">"&amp;output_dir./&amp;prog_name."</span></span>
<span></span>
<span><span class="co"># Get listing data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"&amp;data_dir./&amp;data_file."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create table object</span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://reporter.r-sassy.org/reference/create_table.html" class="external-link">create_table</a></span><span class="op">(</span><span class="va">`&amp;data_name.`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/define.html" class="external-link">define</a></span><span class="op">(</span><span class="va">USUBJID</span>, id_var <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#% Assign default output type</span></span>
<span><span class="co">#%if (%symexist(output_type) == FALSE)</span></span>
<span><span class="co">#%let output_type &lt;- RTF</span></span>
<span><span class="co">#%end</span></span>
<span></span>
<span><span class="co"># Create report object</span></span>
<span><span class="va">rpt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://reporter.r-sassy.org/reference/create_report.html" class="external-link">create_report</a></span><span class="op">(</span><span class="va">out_pth</span>, font <span class="op">=</span> <span class="st">"Courier"</span>, output_type <span class="op">=</span> <span class="st">"&amp;output_type."</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/page_header.html" class="external-link">page_header</a></span><span class="op">(</span><span class="st">"Sponsor: &amp;sponsor_name."</span>, <span class="st">"Study: &amp;study_name."</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/titles.html" class="external-link">titles</a></span><span class="op">(</span><span class="va">`&amp;titles.`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/add_content.html" class="external-link">add_content</a></span><span class="op">(</span><span class="va">tbl</span>, align <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/footnotes.html" class="external-link">footnotes</a></span><span class="op">(</span><span class="va">`&amp;footnotes.`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/page_footer.html" class="external-link">page_footer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"CONFIDENTIAL"</span>, <span class="st">"Page [pg] of [tpg]"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Write report to file</span></span>
<span><span class="co">#%if (&amp;preview. == TRUE)</span></span>
<span><span class="fu"><a href="https://reporter.r-sassy.org/reference/write_report.html" class="external-link">write_report</a></span><span class="op">(</span><span class="va">rpt</span>, preview <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#%else</span></span>
<span><span class="fu"><a href="https://reporter.r-sassy.org/reference/write_report.html" class="external-link">write_report</a></span><span class="op">(</span><span class="va">rpt</span><span class="op">)</span></span>
<span><span class="co">#%end</span></span></code></pre></div>
<p>One piece of logic added to this template is to set the
<code>output_type.</code> macro variable to “RTF” if it does not exist.
This example demonstrates the use of the <code>%symexist()</code>
function.</p>
<p>Another piece of macro logic added is to optionally preview the
report. If <code>preview.</code> is set to TRUE, the macro will append a
parameter to <code><a href="https://reporter.r-sassy.org/reference/write_report.html" class="external-link">write_report()</a></code> to only print the first page of
the report. This option can reduce the amount of time the program runs
while you are developing.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-to-run">How To Run<a class="anchor" aria-label="anchor" href="#how-to-run"></a>
</h2>
<p>Since the call to <code><a href="../reference/msource.html">msource()</a></code> is included directly in the
macro driver script, you can source the script normally in RStudio or
another editor. When executed, the script will write the following to
the console:</p>
<pre><code>&gt; source("C:/packages/macro/tests/testthat/examples/Example2.R")
******************************************************************************** 
**  Pre-Processing 
******************************************************************************** 
-    File In: c:/packages/macro/tests/testthat/examples/templates/lst02.R 
-   File Out: c:/packages/macro/tests/testthat/examples/code/l_dm2.R 
******************************************************************************** 
[ In#][Out#]: 
[   1][   1]: ##################################################################### 
[   2][   2]: # Program Name: l_dm 
[   3][   3]: # Study: ABC 
[   4][   4]: ##################################################################### 
[   5][   5]:  
[   6][   6]: library(reporter) 
[   7][   7]:  
[   8][   8]: # Output path 
[   9][   9]: out_pth &lt;- "c:/packages/macro/tests/testthat/examples/output/l_dm" 
[  10][  10]:  
[  11][  11]: # Get listing data 
[  12][  12]: load("c:/packages/macro/tests/testthat/examples/data/dm.rda") 
[  13][  13]:  
[  14][  14]: # Create table object 
[  15][  15]: tbl &lt;- create_table(dm) |&gt; 
[  16][  16]:   define(USUBJID, id_var = TRUE) 
[  17][  17]:  
[  18][    ]: #% Assign default output type 
[  19][    ]: #%if (TRUE == FALSE) 
[  20][    ]: #%let output_type &lt;- RTF 
[  21][    ]: #%end 
[  22][    ]:  
[  23][  18]: # Create report object 
[  24][  19]: rpt &lt;- create_report(out_pth, font = "Courier", output_type = "PDF") |&gt; 
[  25][  20]:   page_header("Sponsor: Acme", "Study: ABC") |&gt; 
[  26][  21]:   titles(c('Listing 1.0', 'SDTM Demographics')) |&gt; 
[  27][  22]:   add_content(tbl, align = "left") |&gt; 
[  28][  23]:   footnotes('Program: l_dm.R') |&gt; 
[  29][  24]:   page_footer(Sys.time(), "CONFIDENTIAL", "Page [pg] of [tpg]") 
[  30][  25]:  
[  31][  26]: # Write report to file 
[  32][    ]: #%if (&amp;preview. == TRUE) 
[  33][  27]: write_report(rpt, preview = 1) 
[  34][    ]: #%else 
[  35][    ]: write_report(rpt) 
[  36][    ]: #%end 
******************************************************************************** 
**  Execution 
******************************************************************************** 

&gt; #####################################################################
&gt; # Program Name: l_dm
&gt; # Study: ABC
&gt; ###################################### .... [TRUNCATED] 

&gt; # Output path
&gt; out_pth &lt;- "c:/packages/macro/tests/testthat/examples/output/l_dm"

&gt; # Get listing data
&gt; load("c:/packages/macro/tests/testthat/examples/data/dm.rda")

&gt; # Create table object
&gt; tbl &lt;- create_table(dm) |&gt;
+   define(USUBJID, id_var = TRUE)

&gt; # Create report object
&gt; rpt &lt;- create_report(out_pth, font = "Courier", output_type = "PDF") |&gt;
+   page_header("Sponsor: Acme", "Study: ABC") |&gt;
+ .... [TRUNCATED] 

&gt; # Write report to file
&gt; write_report(rpt, preview = 1)
# A report specification: 1 pages  PREVIEW
- file_path: 'c:/packages/macro/tests/testthat/examples/output/l_dm.pdf'
- output_type: PDF
- units: inches
- orientation: landscape
- margins: top 0.5 bottom 0.5 left 1 right 1
- line size/count: 9/47
- page_header: left=Sponsor: Acme right=Study: ABC
- title 1: 'Listing 1.0'
- title 2: 'SDTM Demographics'
- footnote 1: 'Program: l_dm.R'
- page_footer: left=2025-11-16 00:17:40.081514 center=CONFIDENTIAL right=Page [pg] of [tpg]
- content: 
# A table specification:
- data: tibble 'dm' 87 rows 24 cols
- show_cols: all
- use_attributes: all
- define: USUBJID id_var='TRUE' 
 
******************************************************************************** 
**  End 
******************************************************************************** </code></pre>
<p>The debug information contains a pre-processor section and a section
for execution of the generated code. These two sections can help you
isolate problems with your program.</p>
<p>For more information on debugging, see the <a href="macro-debug.html">debugging vignette</a>.</p>
<div class="section level3">
<h3 id="generated-code">Generated Code<a class="anchor" aria-label="anchor" href="#generated-code"></a>
</h3>
<p>Upon execution, the generated code file will look like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#####################################################################</span></span>
<span><span class="co"># Program Name: l_dm</span></span>
<span><span class="co"># Study: ABC</span></span>
<span><span class="co">#####################################################################</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://reporter.r-sassy.org" class="external-link">reporter</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output path</span></span>
<span><span class="va">out_pth</span> <span class="op">&lt;-</span> <span class="st">"c:/packages/macro/tests/testthat/examples/output/l_dm"</span></span>
<span></span>
<span><span class="co"># Get listing data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"c:/packages/macro/tests/testthat/examples/data/dm.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create table object</span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://reporter.r-sassy.org/reference/create_table.html" class="external-link">create_table</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/define.html" class="external-link">define</a></span><span class="op">(</span><span class="va">USUBJID</span>, id_var <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create report object</span></span>
<span><span class="va">rpt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://reporter.r-sassy.org/reference/create_report.html" class="external-link">create_report</a></span><span class="op">(</span><span class="va">out_pth</span>, font <span class="op">=</span> <span class="st">"Courier"</span>, output_type <span class="op">=</span> <span class="st">"PDF"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/page_header.html" class="external-link">page_header</a></span><span class="op">(</span><span class="st">"Sponsor: Acme"</span>, <span class="st">"Study: ABC"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/titles.html" class="external-link">titles</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Listing 1.0'</span>, <span class="st">'SDTM Demographics'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/add_content.html" class="external-link">add_content</a></span><span class="op">(</span><span class="va">tbl</span>, align <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/footnotes.html" class="external-link">footnotes</a></span><span class="op">(</span><span class="st">'Program: l_dm.R'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://reporter.r-sassy.org/reference/page_footer.html" class="external-link">page_footer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"CONFIDENTIAL"</span>, <span class="st">"Page [pg] of [tpg]"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Write report to file</span></span>
<span><span class="fu"><a href="https://reporter.r-sassy.org/reference/write_report.html" class="external-link">write_report</a></span><span class="op">(</span><span class="va">rpt</span>, preview <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The listing code above is identical to the previous listing, except
the output type is “PDF” and the <code>preview</code> parameter is set
on the call to <code><a href="https://reporter.r-sassy.org/reference/write_report.html" class="external-link">write_report()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="output-report">Output Report<a class="anchor" aria-label="anchor" href="#output-report"></a>
</h3>
<p>Here is the output report for the modified listing:</p>
<p><img src="../man/images/example2.png" alt="Second listing example output"></p>
<p>Next: <a href="macro-example3.html">Example 3: Table</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
